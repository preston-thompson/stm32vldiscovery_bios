#define NVIC_ADDR 0xE000E100

#define NVIC_ISER0_OFFS 0x00
#define NVIC_ISER1_OFFS 0x04

#define NVIC_ISER1_USART1_MASK (1 << 5)

#define RCC_ADDR 0x40021000

#define RCC_APB2RSTR_OFFS 0x0C

#define RCC_APB1RSTR_OFFS 0x10

#define RCC_APB1ENR_OFFS 0x1C
#define RCC_APB1ENR_USART2EN_MASK (1 << 17)
#define RCC_APB1ENR_USART3EN_MASK (1 << 18)
#define RCC_APB1ENR_USART4EN_MASK (1 << 19)
#define RCC_APB1ENR_USART5EN_MASK (1 << 20)

#define RCC_APB2ENR_OFFS 0x18
#define RCC_APB2ENR_USART1EN_MASK (1 << 14)
#define RCC_APB2ENR_IOPAEN_MASK (1 << 2)
#define RCC_APB2ENR_AFIOEN_MASK (1 << 0)

#define RCC_CIR_OFFS 0x08

#define GPIO_PORTA_ADDR 0x40010800
#define GPIO_CRH_OFFS 0x04
#define GPIO_CRH_MODE9_MASK 0x30
#define GPIO_CRH_MODE9_POS 4
#define GPIO_CRH_CNF9_MASK 0xC0
#define GPIO_CRH_CNF9_POS 6
#define GPIO_CRH_MODE10_MASK 0x300
#define GPIO_CRH_MODE10_POS 8
#define GPIO_CRH_CNF10_MASK 0xC00
#define GPIO_CRH_CNF10_POS 10

#define USART1_ADDR 0x40013800

#define USART_SR_OFFS 0x00
#define USART_SR_TC_MASK (1 << 6)
#define USART_SR_TXE_MASK (1 << 7)
#define USART_SR_RXNE_MASK (1 << 5)
#define USART_DR_OFFS 0x04
#define USART_BRR_OFFS 0x08
#define USART_BRR_DIV_FRACTION_MASK 0xF
#define USART_BRR_DIV_FRACTION_POS 0
#define USART_BRR_DIV_MANTISSA_MASK 0xFFF0
#define USART_BRR_DIV_MANTISSA_POS 4
#define USART_CR1_OFFS 0x0C
#define USART_CR1_RE_MASK (1 << 2)
#define USART_CR1_TE_MASK (1 << 3)
#define USART_CR1_RXNEIE_MASK (1 << 5)
#define USART_CR1_TXEIE_MASK (1 << 7)
#define USART_CR1_TCIE_MASK (1 << 6)
#define USART_CR1_UE_MASK (1 << 13)
#define USART_CR2_OFFS 0x10
#define USART_CR3_OFFS 0x14
#define USART_GTPR_OFFS 0x18

#define USART1_INTERRUPT_VECTOR_ADDR 0x000000D4
